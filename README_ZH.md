<div align="center">
  <p align="center">

<picture>
    <img alt="KTransformers" src="https://github.com/user-attachments/assets/d5a2492f-a415-4456-af99-4ab102f13f8b" width=50%>

</picture>

</p>
  <h3>ä¸€ä¸ªç”¨äºä½“éªŒå°–ç«¯ LLM æ¨ç†/å¾®è°ƒä¼˜åŒ–çš„çµæ´»æ¡†æ¶</h3>
  <strong><a href="#-æ¦‚è§ˆ">ğŸ¯ æ¦‚è§ˆ</a> | <a href="#-kt-kernel---é«˜æ€§èƒ½æ¨ç†å†…æ ¸">ğŸš€ kt-kernel</a> | <a href="#-kt-sft---å¾®è°ƒæ¡†æ¶">ğŸ“ kt-sft</a> | <a href="#-å¼•ç”¨">ğŸ”¥ å¼•ç”¨</a> </strong>
</div>

## ğŸ¯ æ¦‚è§ˆ

KTransformers æ˜¯ä¸€ä¸ªä¸“æ³¨äºé€šè¿‡ CPU-GPU å¼‚æ„è®¡ç®—å®ç°å¤§è¯­è¨€æ¨¡å‹é«˜æ•ˆæ¨ç†å’Œå¾®è°ƒçš„ç ”ç©¶é¡¹ç›®ã€‚è¯¥é¡¹ç›®å·²å‘å±•ä¸º**ä¸¤ä¸ªæ ¸å¿ƒæ¨¡å—**ï¼š[kt-kernel](./kt-kernel/) å’Œ [kt-sft](./kt-sft/)ã€‚

## ğŸ”¥ æ›´æ–°

* **2025 å¹´ 12 æœˆ 5 æ—¥**ï¼šæ”¯æŒåŸç”Ÿ Kimi-K2-Thinking æ¨ç†ï¼ˆ[æ•™ç¨‹](./doc/en/Kimi-K2-Thinking-Native.md)ï¼‰
* **2025 å¹´ 11 æœˆ 6 æ—¥**ï¼šæ”¯æŒ Kimi-K2-Thinking æ¨ç†ï¼ˆ[æ•™ç¨‹](./doc/en/Kimi-K2-Thinking.md)ï¼‰å’Œå¾®è°ƒï¼ˆ[æ•™ç¨‹](./doc/en/SFT_Installation_Guide_KimiK2.md)ï¼‰
* **2025 å¹´ 11 æœˆ 4 æ—¥**ï¼šKTransformers å¾®è°ƒ Ã— LLaMA-Factory é›†æˆï¼ˆ[æ•™ç¨‹](./doc/en/KTransformers-Fine-Tuning_User-Guide.md)ï¼‰
* **2025 å¹´ 10 æœˆ 27 æ—¥**ï¼šæ”¯æŒæ˜‡è…¾ NPUï¼ˆ[æ•™ç¨‹](./doc/zh/DeepseekR1_V3_tutorial_zh_for_Ascend_NPU.md)ï¼‰
* **2025 å¹´ 10 æœˆ 10 æ—¥**ï¼šé›†æˆåˆ° SGLangï¼ˆ[è·¯çº¿å›¾](https://github.com/sgl-project/sglang/issues/11425)ï¼Œ[åšå®¢](https://lmsys.org/blog/2025-10-22-KTransformers/)ï¼‰
* **2025 å¹´ 9 æœˆ 11 æ—¥**ï¼šæ”¯æŒ Qwen3-Nextï¼ˆ[æ•™ç¨‹](./doc/en/Qwen3-Next.md)ï¼‰
* **2025 å¹´ 9 æœˆ 5 æ—¥**ï¼šæ”¯æŒ Kimi-K2-0905ï¼ˆ[æ•™ç¨‹](./doc/en/Kimi-K2.md)ï¼‰
* **2025 å¹´ 7 æœˆ 26 æ—¥**ï¼šæ”¯æŒ SmallThinker å’Œ GLM4-MoEï¼ˆ[æ•™ç¨‹](./doc/en/SmallThinker_and_Glm4moe.md)ï¼‰
* **2025 å¹´ 7 æœˆ 11 æ—¥**ï¼šæ”¯æŒ Kimi-K2ï¼ˆ[æ•™ç¨‹](./doc/en/Kimi-K2.md)ï¼‰
* **2025 å¹´ 6 æœˆ 30 æ—¥**ï¼šæ”¯æŒ 3 å±‚ï¼ˆGPU-CPU-ç£ç›˜ï¼‰[å‰ç¼€ç¼“å­˜](./doc/en/prefix_cache.md)å¤ç”¨
* **2025 å¹´ 5 æœˆ 14 æ—¥**ï¼šæ”¯æŒ Intel Arc GPUï¼ˆ[æ•™ç¨‹](./doc/en/xpu.md)ï¼‰
* **2025 å¹´ 4 æœˆ 29 æ—¥**ï¼šæ”¯æŒ AMX-Int8ã€AMX-BF16 å’Œ Qwen3MoEï¼ˆ[æ•™ç¨‹](./doc/en/AMX.md)ï¼‰
* **2025 å¹´ 4 æœˆ 9 æ—¥**ï¼šå®éªŒæ€§æ”¯æŒ LLaMA 4 æ¨¡å‹ï¼ˆ[æ•™ç¨‹](./doc/en/llama4.md)ï¼‰
* **2025 å¹´ 4 æœˆ 2 æ—¥**ï¼šæ”¯æŒå¤šå¹¶å‘ï¼ˆ[æ•™ç¨‹](./doc/en/balance-serve.md)ï¼‰
* **2025 å¹´ 3 æœˆ 15 æ—¥**ï¼šæ”¯æŒ AMD GPU ä¸Šçš„ ROCmï¼ˆ[æ•™ç¨‹](./doc/en/ROCm.md)ï¼‰
* **2025 å¹´ 3 æœˆ 5 æ—¥**ï¼šæ”¯æŒ unsloth 1.58/2.51 ä½æƒé‡å’Œ [IQ1_S/FP8 æ··åˆ](./doc/en/fp8_kernel.md)æƒé‡ã€‚åœ¨ 24GB VRAM ä¸­æ”¯æŒ DeepSeek-V3 å’Œ R1 çš„ 139K [æ›´é•¿ä¸Šä¸‹æ–‡](./doc/en/DeepseekR1_V3_tutorial.md#v022--v023-longer-context--fp8-kernel)
* **2025 å¹´ 2 æœˆ 25 æ—¥**ï¼šä¸º DeepSeek-V3 å’Œ R1 æ”¯æŒ [FP8 GPU å†…æ ¸](./doc/en/fp8_kernel.md)ï¼›[æ›´é•¿ä¸Šä¸‹æ–‡](./doc/en/DeepseekR1_V3_tutorial.md#v022-longer-context)
* **2025 å¹´ 2 æœˆ 15 æ—¥**ï¼šæ›´é•¿ä¸Šä¸‹æ–‡ï¼ˆ24GB VRAM ä» 4K åˆ° 8Kï¼‰& é€Ÿåº¦ç¨å¿«ï¼ˆ+15%ï¼Œæœ€é«˜ 16 Tokens/sï¼‰ï¼Œæ›´æ–°[æ–‡æ¡£](./doc/en/DeepseekR1_V3_tutorial.md)å’Œ[åœ¨çº¿æ‰‹å†Œ](https://kvcache-ai.github.io/ktransformers/)
* **2025 å¹´ 2 æœˆ 10 æ—¥**ï¼šæ”¯æŒ Deepseek-R1 å’Œ V3 åœ¨å• GPUï¼ˆ24GB VRAMï¼‰/å¤š GPU å’Œ 382GB DRAM ä¸Šè¿è¡Œï¼Œé€Ÿåº¦æå‡é«˜è¾¾ 3~28 å€ã€‚è¯¦ç»†æ¡ˆä¾‹å±•ç¤ºå’Œå¤ç°æ•™ç¨‹è¯·å‚è§[è¿™é‡Œ](./doc/en/DeepseekR1_V3_tutorial.md)
* **2024 å¹´ 8 æœˆ 28 æ—¥**ï¼šå°† DeepseekV2 æ‰€éœ€çš„ VRAM ä» 21GB é™ä½åˆ° 11GB
* **2024 å¹´ 8 æœˆ 15 æ—¥**ï¼šæ›´æ–°äº†å…³äºæ³¨å…¥å’Œå¤š GPU çš„è¯¦ç»†[æ•™ç¨‹](doc/en/injection_tutorial.md)
* **2024 å¹´ 8 æœˆ 14 æ—¥**ï¼šæ”¯æŒ llamfile ä½œä¸ºçº¿æ€§åç«¯
* **2024 å¹´ 8 æœˆ 12 æ—¥**ï¼šæ”¯æŒå¤š GPUï¼›æ”¯æŒæ–°æ¨¡å‹ï¼šmixtral 8\*7B å’Œ 8\*22Bï¼›æ”¯æŒ GPU ä¸Šçš„ q2kã€q3kã€q5k å»é‡åŒ–
* **2024 å¹´ 8 æœˆ 9 æ—¥**ï¼šæ”¯æŒ Windows åŸç”Ÿç¯å¢ƒ

---

## ğŸ“¦ æ ¸å¿ƒæ¨¡å—

### ğŸš€ [kt-kernel](./kt-kernel/) - é«˜æ€§èƒ½æ¨ç†å†…æ ¸

ç”¨äºå¼‚æ„ LLM æ¨ç†çš„ CPU ä¼˜åŒ–å†…æ ¸æ“ä½œã€‚

![image-20251011010558909](./doc/assets/heterogeneous_computing.png)

**ä¸»è¦ç‰¹æ€§ï¼š**
- **AMX/AVX åŠ é€Ÿ**ï¼šIntel AMX å’Œ AVX512/AVX2 ä¼˜åŒ–çš„å†…æ ¸ï¼Œç”¨äº INT4/INT8 é‡åŒ–æ¨ç†
- **MoE ä¼˜åŒ–**ï¼šé«˜æ•ˆçš„ä¸“å®¶æ··åˆæ¨ç†ï¼Œå…·æœ‰ NUMA æ„ŸçŸ¥å†…å­˜ç®¡ç†
- **é‡åŒ–æ”¯æŒ**ï¼šCPU ç«¯ INT4/INT8 é‡åŒ–æƒé‡ï¼ŒGPU ç«¯ GPTQ æ”¯æŒ
- **æ˜“äºé›†æˆ**ï¼šä¸º SGLang å’Œå…¶ä»–æ¡†æ¶æä¾›ç®€æ´çš„ Python API

**å¿«é€Ÿå¼€å§‹ï¼š**
```bash
cd kt-kernel
pip install .
```

**ä½¿ç”¨åœºæ™¯ï¼š**

- å¤§å‹ MoE æ¨¡å‹çš„ CPU-GPU æ··åˆæ¨ç†
- ä¸ SGLang é›†æˆç”¨äºç”Ÿäº§æœåŠ¡
- å¼‚æ„ä¸“å®¶æ”¾ç½®ï¼ˆçƒ­ä¸“å®¶åœ¨ GPU ä¸Šï¼Œå†·ä¸“å®¶åœ¨ CPU ä¸Šï¼‰

**æ€§èƒ½ç¤ºä¾‹ï¼š**
| æ¨¡å‹ | ç¡¬ä»¶é…ç½® | æ€»ååé‡ | è¾“å‡ºååé‡ |
|-------|------------------------|------------------|-------------------|
| DeepSeek-R1-0528 (FP8) | 8Ã—L20 GPU + Xeon Gold 6454S | 227.85 tokens/s | 87.58 tokens/sï¼ˆ8 è·¯å¹¶å‘ï¼‰|

ğŸ‘‰ **[å®Œæ•´æ–‡æ¡£ â†’](./kt-kernel/README.md)**

---

### ğŸ“ [kt-sft](./kt-sft/) - å¾®è°ƒæ¡†æ¶

KTransformers Ã— LLaMA-Factory é›†æˆï¼Œç”¨äºè¶…å¤§å‹ MoE æ¨¡å‹å¾®è°ƒã€‚

![image-20251011010558909](./doc/assets/image-20251011010558909.png)

**ä¸»è¦ç‰¹æ€§ï¼š**

- **èµ„æºé«˜æ•ˆ**ï¼šä»…éœ€ **70GB GPU æ˜¾å­˜** + 1.3TB å†…å­˜å³å¯å¾®è°ƒ 671B DeepSeek-V3
- **LoRA æ”¯æŒ**ï¼šå®Œæ•´çš„ LoRA å¾®è°ƒï¼Œå¸¦æœ‰å¼‚æ„åŠ é€Ÿ
- **LLaMA-Factory é›†æˆ**ï¼šä¸æµè¡Œçš„å¾®è°ƒæ¡†æ¶æ— ç¼é›†æˆ
- **ç”Ÿäº§å°±ç»ª**ï¼šèŠå¤©ã€æ‰¹é‡æ¨ç†å’ŒæŒ‡æ ‡è¯„ä¼°

**æ€§èƒ½ç¤ºä¾‹ï¼š**

| æ¨¡å‹ | é…ç½® | ååé‡ | GPU æ˜¾å­˜ |
|-------|--------------|------------|--------------|
| DeepSeek-V3 (671B) | LoRA + AMX | ~40 tokens/s | 70GBï¼ˆå¤š GPUï¼‰|
| DeepSeek-V2-Lite (14B) | LoRA + AMX | ~530 tokens/s | 6GB |

**å¿«é€Ÿå¼€å§‹ï¼š**
```bash
cd kt-sft
# æŒ‰ç…§ kt-sft/README.md å®‰è£…ç¯å¢ƒ
USE_KT=1 llamafactory-cli train examples/train_lora/deepseek3_lora_sft_kt.yaml
```

ğŸ‘‰ **[å®Œæ•´æ–‡æ¡£ â†’](./kt-sft/README.md)**

---

## ğŸ”¥ å¼•ç”¨

å¦‚æœæ‚¨åœ¨ç ”ç©¶ä¸­ä½¿ç”¨äº† KTransformersï¼Œè¯·å¼•ç”¨æˆ‘ä»¬çš„è®ºæ–‡ï¼š

```bibtex
@inproceedings{10.1145/3731569.3764843,
  title = {KTransformers: Unleashing the Full Potential of CPU/GPU Hybrid Inference for MoE Models},
  author = {Chen, Hongtao and Xie, Weiyu and Zhang, Boxin and Tang, Jingqi and Wang, Jiahao and Dong, Jianwei and Chen, Shaoyuan and Yuan, Ziwei and Lin, Chen and Qiu, Chengyu and Zhu, Yuening and Ou, Qingliang and Liao, Jiaqi and Chen, Xianglin and Ai, Zhiyuan and Wu, Yongwei and Zhang, Mingxing},
  booktitle = {Proceedings of the ACM SIGOPS 31st Symposium on Operating Systems Principles},
  year = {2025}
}
```

## ğŸ‘¥ è´¡çŒ®è€…ä¸å›¢é˜Ÿ

ç”±ä»¥ä¸‹å›¢é˜Ÿå¼€å‘å’Œç»´æŠ¤ï¼š
- æ¸…åå¤§å­¦ [MADSys å®éªŒå®¤](https://madsys.cs.tsinghua.edu.cn/)
- [Approaching.AI](http://approaching.ai/)
- ç¤¾åŒºè´¡çŒ®è€…

æˆ‘ä»¬æ¬¢è¿è´¡çŒ®ï¼è¯·éšæ—¶æäº¤é—®é¢˜å’Œæ‹‰å–è¯·æ±‚ã€‚

## ğŸ’¬ ç¤¾åŒºä¸æ”¯æŒ

- **GitHub Issues**ï¼š[æŠ¥å‘Šé—®é¢˜æˆ–è¯·æ±‚åŠŸèƒ½](https://github.com/kvcache-ai/ktransformers/issues)
- **å¾®ä¿¡ç¾¤**ï¼šè¯·å‚è§ [archive/WeChatGroup.png](./archive/WeChatGroup.png)

## ğŸ“¦ KTåŸä»“åº“

åŸå§‹çš„é›†æˆ KTransformers æ¡†æ¶å·²å½’æ¡£åˆ° [`archive/`](./archive/) ç›®å½•ä»¥ä¾›å‚è€ƒã€‚è¯¥é¡¹ç›®ç°åœ¨ä¸“æ³¨äºä¸Šè¿°ä¸¤ä¸ªæ ¸å¿ƒæ¨¡å—ï¼Œä»¥è·å¾—æ›´å¥½çš„æ¨¡å—åŒ–å’Œå¯ç»´æŠ¤æ€§ã€‚

æœ‰å…³åŸå§‹æ–‡æ¡£ä»¥åŠå®Œæ•´çš„å¿«é€Ÿå…¥é—¨æŒ‡å—å’Œç¤ºä¾‹ï¼Œè¯·å‚è§ï¼š
- [archive/README.md](./archive/README.md)ï¼ˆè‹±æ–‡ï¼‰
- [archive/README_ZH.md](./archive/README_ZH.md)ï¼ˆä¸­æ–‡ï¼‰
